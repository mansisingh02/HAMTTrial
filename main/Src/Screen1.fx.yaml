Screen1 As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)

    Rectangle2_2 As rectangle:
        BorderColor: =RGBA(179, 179, 179, 1)
        BorderThickness: =2
        DisabledFill: =RGBA(166, 166, 166, 1)
        Fill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =317
        HoverFill: =RGBA(0, 0, 0, 0)
        PressedFill: =RGBA(0, 0, 0, 0)
        Width: =477
        X: =427
        Y: =222
        ZIndex: =1

    SkillsTextInput As text:
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        Default: ="Text input"
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        HintText: ="Name of the skill you wish to add"
        HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverColor: =RGBA(51, 51, 51, 1)
        HoverFill: =RGBA(255, 255, 255, 1)
        PressedBorderColor: =RGBA(0, 120, 212, 1)
        PressedColor: =RGBA(51, 51, 51, 1)
        PressedFill: =RGBA(255, 255, 255, 1)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =10.75
        X: =505
        Y: =329
        ZIndex: =2

    msft_Button_29 As button:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =0
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Fill: =RGBA(0, 51, 142, 1)
        FocusedBorderColor: =ColorFade(Self.Fill, -75%)
        FontWeight: =FontWeight.Bold
        Height: =36
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(0, 120, 212, 1), -10%)
        OnSelect: |+
            =// Store the value from the text input in a variable
            Set(
                NewSkillInput,
                SkillsTextInput.Text
            );
            
            // Find the current user's core leader
            Set(
                CoreLeader,
                LookUp(Caregivers_1, 'Caregiver Email' = User().Email).'Core Leader'
            );
            
            // Output the value of CoreLeader for debugging
            Notify("Core Leader: " & CoreLeader, NotificationType.Information);
            
            // Find the email address of the core leader
            Set(
                CoreLeaderEmail,
                LookUp(Caregivers_1, 'Caregiver Name' = CoreLeader).'Caregiver Email'
            );
            
            // Output the value of CoreLeaderEmail for debugging
            Notify("Core Leader Email: " & CoreLeaderEmail, NotificationType.Information);
            
            // Find the email address of the admin
            Set(
                AdminEmail,
                "mansi.singh@providence.org"
            );
            
            // Send email to the admin
            If(
                !IsBlank(AdminEmail),
                Office365Outlook.SendEmailV2(
                    AdminEmail,
                    "Request for New Skill",
                    "Hi Admin,\n\nI am requesting the addition of a new skill (" & NewSkillInput & ") to the system.\n\nThank you,\n" & User().FullName
                );
                Notify("Email sent successfully to admin.", NotificationType.Success)
            );
            
            // Send email to the core leader if CoreLeaderEmail is not blank
            /*If(
                !IsBlank(CoreLeaderEmail),
                Office365Outlook.SendEmailV2(
                    CoreLeaderEmail,
                    "Request for New Skill",
                    "Hi Core Leader,\n\nI am requesting the addition of a new skill (" & NewSkillInput & ") to the system.\n\nThank you,\n" & User().FullName
                );
                Notify("Email sent successfully to core leader.", NotificationType.Success),
                Notify("Error: Core leader email address not found", NotificationType.Error)
            )*/
            
            
        PaddingBottom: =7
        PaddingLeft: =32
        PaddingRight: =32
        PaddingTop: =8
        PressedBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -50%)
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        RadiusBottomLeft: =5
        RadiusBottomRight: =5
        RadiusTopLeft: =5
        RadiusTopRight: =5
        Size: =10.75
        Text: ="Submit"
        VerticalAlign: =VerticalAlign.Top
        Width: =117
        X: =594
        Y: =411
        ZIndex: =3

