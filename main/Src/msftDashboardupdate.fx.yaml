msftDashboardupdate As screen:
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |+
        =// Retrieve data from SharePoint lists
        ClearCollect(
            CaregiversData,
            Caregivers_1
        );
        
        Set(
            LevelColumnName,
            "Level"
        );
        
        // Initialize dictionary to store counts for each level
        ClearCollect(
            LevelCounts,
            AddColumns(
                Distinct(CaregiversData, Level), // Get unique values from the "Level" column
                "LevelName",
                LevelColumnName
            )
        );
        
        // Iterate through each level and count caregivers
        ForAll(
            LevelCounts,
            {
                LevelName: ThisRecord.LevelName,
                CaregiverCount: CountIf(CaregiversData,Level = ThisRecord.Level) // Count caregivers where the "Level" matches
            }
        );
        
        
        
        
        
        
        
        
        
        
        
        
        
        

    Container3_1 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =75
        ZIndex: =11

        navBarVertical_admin_44 As navBarVertical_admin:
            caregiversNav: =msftcaregivers
            dasboardNav: =msftDashboardupdate
            Height: =Parent.Height
            LayoutMinHeight: =640
            LayoutMinWidth: =640
            masterDataNav: =msftMasterData
            projectNav: =msftproject
            Visible: =true

    Container1_1 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.Light
        Height: =60
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        ZIndex: =12

        navBarHorizontal_44 As navBarHorizontal:
            Height: =Parent.Height
            LayoutMinHeight: =640
            LayoutMinWidth: =640
            Width: =Parent.Width

    CompositePieChart2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =13

        Title12 As label:
            Align: =Align.Center
            Color: =RGBA(51, 51, 51, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =21
            Size: =12
            Text: ="Number of Caregivers at a Level"
            Width: =356
            X: =911
            Y: =166
            ZIndex: =14

        PieChart2 As pieChart:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Font: =Font.'Segoe UI'
            Height: =343
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            ItemColorSet: =[RGBA(49, 130, 93, 1),RGBA(48,166,103, 1), RGBA(94,193,108,1), RGBA(246,199,144,1), RGBA(247,199,114,1), RGBA(247,180,91,1), RGBA(246,143,100,1), RGBA(212,96,104,1), RGBA(148, 110, 176, 1), RGBA(118, 154, 204, 1), RGBA(96, 197, 234, 1)]
            Items: |-
                =AddColumns(
                    GroupBy(
                        AddColumns(
                            'Caregivers_1',
                            "LevelValue",
                            Level.Value
                        ),
                        "LevelValue",
                        "Detail"
                    ),
                    "Count",
                    CountRows(ThisRecord.Detail)
                )
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            Size: =15
            Width: =356
            X: =916
            Y: =192
            ZIndex: =15

        Legend2 As legend:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(220, 220, 220, 1)
            Font: =Font.'Segoe UI'
            Height: =171
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            ItemColorSet: =PieChart2.ItemColorSet
            Items: =PieChart2.SeriesLabels
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            Width: =356
            X: =911
            Y: =535
            ZIndex: =16

    CompositePieChart2_1 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =17

        Title12_1 As label:
            Align: =Align.Center
            Color: =RGBA(51, 51, 51, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =22
            Size: =12
            Text: ="Number of Caregivers in a Cost Center"
            Width: =375
            X: =489
            Y: =166
            ZIndex: =18

        PieChart2_1 As pieChart:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Font: =Font.'Segoe UI'
            Height: =352
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            ItemColorSet: =[RGBA(49, 130, 93, 1),RGBA(48,166,103, 1), RGBA(94,193,108,1), RGBA(246,199,144,1), RGBA(247,199,114,1), RGBA(247,180,91,1), RGBA(246,143,100,1), RGBA(212,96,104,1), RGBA(148, 110, 176, 1), RGBA(118, 154, 204, 1), RGBA(96, 197, 234, 1)]
            Items: |-
                =AddColumns(
                    GroupBy(
                        AddColumns(
                            'Caregivers_1',
                            "CostCenterValue",
                            'Pillar Name'
                        ),
                        "CostCenterValue",
                        "Detail"
                    ),
                    "Count",
                    CountRows(ThisRecord.Detail)
                )
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            Size: =9
            Width: =375
            X: =501
            Y: =194
            ZIndex: =19

        Legend2_1 As legend:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(220, 220, 220, 1)
            Font: =Font.'Segoe UI'
            Height: =176
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            ItemColorSet: =PieChart2_1.ItemColorSet
            Items: =PieChart2_1.SeriesLabels
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            Width: =375
            X: =489
            Y: =530
            ZIndex: =20

    CompositePieChart2_2 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =21

        Title12_2 As label:
            Align: =Align.Center
            Color: =RGBA(51, 51, 51, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =21
            Size: =12
            Text: ="Caregivers by Core Leaders"
            Width: =356
            X: =91
            Y: =165
            ZIndex: =22

        PieChart2_2 As pieChart:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Font: =Font.'Segoe UI'
            Height: =343
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            ItemColorSet: =[RGBA(49, 130, 93, 1),RGBA(48,166,103, 1), RGBA(94,193,108,1), RGBA(246,199,144,1), RGBA(247,199,114,1), RGBA(247,180,91,1), RGBA(246,143,100,1), RGBA(212,96,104,1), RGBA(148, 110, 176, 1), RGBA(118, 154, 204, 1), RGBA(96, 197, 234, 1)]
            Items: |-
                =AddColumns(
                    GroupBy(
                        AddColumns(
                            'Caregivers_1',
                            "LevelValue",
                            'Core Leader'
                        ),
                        "LevelValue",
                        "Detail"
                    ),
                    "Count",
                    CountRows(ThisRecord.Detail)
                )
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            Size: =11
            Width: =356
            X: =117
            Y: =191
            ZIndex: =23

        Legend2_2 As legend:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(51, 51, 51, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            DisabledFill: =RGBA(220, 220, 220, 1)
            Font: =Font.'Segoe UI'
            Height: =171
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            ItemColorSet: =PieChart2_2.ItemColorSet
            Items: =PieChart2_2.SeriesLabels
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            Width: =356
            X: =112
            Y: =534
            ZIndex: =24

