"msftsupportemail As screen.'tabletLayout_Email_ver3.0'":
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: |+
        =//Collect(MyPeople, First(Office365Users.SearchUser({top:1,searchTerm:"mansi.singh@providence.org"}))) 
        ClearCollect(
            MyPeople,
            {
                Email: "mansi.singh@providence.org",
                UserData: First(Office365Users.SearchUser({top:1, searchTerm: "mansi.singh@providence.org"})).Mail
            },
            {
                Email: "rama.ghodke@providence.org",
                UserData: First(Office365Users.SearchUser({top:1, searchTerm: "rama.ghodke@providence.org"})).Mail
            },
            {
                Email: "sunjoy.prabakaran@providence.org",
                UserData: First(Office365Users.SearchUser({top:1, searchTerm: "sunjoy.prabakaran@providence.org"})).Mail
            }
        )
        
        
        
        
        
        
        

    RectQuickActionBar3 As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        Fill: =RGBA(0, 120, 212, 1)
        Height: =64
        Width: =Parent.Width
        ZIndex: =1

    LblAppName2 As label:
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        Height: =64
        PaddingLeft: =0
        Size: =18
        Text: ="Email"
        Width: =Parent.Width - Self.X - 64
        Wrap: =false
        X: =32
        ZIndex: =2

    iconMail2 As icon.Send:
        BorderColor: =RGBA(0, 0, 0, 0)
        Color: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(240, 240, 240, 0.5)
        DisplayMode: |-
            =/*Email must have a subject and recipients to be sent*/
            If(Len(Trim(TextEmailSubject2.Text)) > 0 && !IsEmpty(MyPeople), DisplayMode.Edit, DisplayMode.Disabled)
        Icon: =Icon.Send
        OnSelect: |-
            =/*Create semicolon separated list of people to email, send the email, reset subject & message fields*/           
            Set(_emailRecipientString, Concat(MyPeople, Mail & ";"));           
            Office365Outlook.SendEmail(_emailRecipientString, TextEmailSubject2.Text, TextEmailMessage2.Text, {Importance:"Normal"});           
            Reset(TextEmailSubject2);           
            Reset(TextEmailMessage2);           
            Clear(MyPeople)
        PaddingBottom: =14
        PaddingLeft: =14
        PaddingRight: =14
        PaddingTop: =14
        PressedFill: =RGBA(0, 0, 0, 0)
        Tooltip: ="Send message"
        X: =Parent.Width - Self.Width
        ZIndex: =3

    LblRecipientCount2 As label:
        Color: =RGBA(51, 51, 51, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        PaddingLeft: =0
        Size: =13
        Text: ="*To (" &CountRows(MyPeople) & ")"
        Width: =EmailPeopleGallery2.Width
        Wrap: =false
        X: =32
        Y: =RectQuickActionBar3.Height + 15
        ZIndex: =4

    TextSearchBox2 As text:
        AccessibleLabel: ="Search people or add email address. At least one recipient is required for a successful submission."
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        Default: =""
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        HintText: ="Search people or add E-mail address"
        HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverColor: =RGBA(51, 51, 51, 1)
        HoverFill: =RGBA(255, 255, 255, 1)
        PaddingLeft: =50
        PressedBorderColor: =RGBA(0, 120, 212, 1)
        PressedColor: =RGBA(51, 51, 51, 1)
        PressedFill: =RGBA(255, 255, 255, 1)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =13
        Width: =Parent.Width - Self.X * 2
        X: =32
        Y: =LblRecipientCount2.Y + LblRecipientCount2.Height + 3
        ZIndex: =5

    SearchIcon2 As icon.Search:
        BorderColor: =RGBA(166, 166, 166, 1)
        Color: =RGBA(0, 120, 212, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =Self.Width
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Search
        PaddingBottom: =8
        PaddingLeft: =8
        PaddingRight: =8
        PaddingTop: =8
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        Tooltip: ="Search"
        Width: =TextSearchBox2.Height
        X: =TextSearchBox2.X + 5
        Y: =TextSearchBox2.Y
        ZIndex: =6

    AddIcon2 As icon.Add:
        BorderColor: =RGBA(166, 166, 166, 1)
        Color: =RGBA(0, 120, 212, 1)
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(220, 220, 220, 1)
        DisabledFill: =RGBA(0, 0, 0, 0)
        FocusedBorderThickness: =4
        Height: =TextSearchBox2.Height
        HoverBorderColor: =RGBA(0, 0, 0, 0)
        HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverFill: =RGBA(0, 0, 0, 0)
        Icon: =Icon.Add
        OnSelect: |-
            =Collect(MyPeople,           
            {DisplayName: TextSearchBox2.Text, UserPrincipalName: TextSearchBox2.Text, Mail: TextSearchBox2.Text});           
            Reset(TextSearchBox2)
        PaddingBottom: =5
        PaddingLeft: =5
        PaddingRight: =5
        PaddingTop: =5
        PressedBorderColor: =RGBA(0, 0, 0, 0)
        PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        PressedFill: =RGBA(0, 0, 0, 0)
        TabIndex: =0
        Tooltip: ="Select to add user to collection"
        Visible: |-
            =!IsBlank(TextSearchBox2.Text) &&           
            
            /*Is user entry a valid email address*/           
            IsMatch(TextSearchBox2.Text, Match.Email)           &&
            
            Not(Trim(TextSearchBox2.Text) in MyPeople.UserPrincipalName)
        Width: =70
        X: =TextSearchBox2.X + TextSearchBox2.Width - Self.Width - 10
        Y: =TextSearchBox2.Y
        ZIndex: =7

    EmailPeopleGallery2 As gallery.SelectedUsersTabletGallery:
        AccessibleLabel: ="User selected people"
        BorderColor: =TextSearchBox2.BorderColor
        Height: |-
            =/*Height adjusts to number of items in gallery*/
            Min((Self.TemplateHeight + Self.TemplatePadding * 2) * RoundUp(CountRows(Self.AllItems) / 4, 0), 182)
        Items: |-
            =/*Collection of user selected people*/
            MyPeople
        Layout: =Layout.Vertical
        ShowScrollbar: =Self.Height >= 182
        TemplateSize: =42
        Width: =Parent.Width - Self.X * 2
        WrapCount: =4
        X: =27
        Y: =TextSearchBox2.Y + TextSearchBox2.Height
        ZIndex: =8

        Rectangle9 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0, 120, 212, 1)
            FocusedBorderThickness: =4
            Height: =Parent.TemplateHeight
            HoverFill: =RGBA(0, 120, 212, 1)
            OnSelect: =Select(Parent)
            PressedFill: =RGBA(0, 120, 212, 1)
            Width: =Parent.TemplateWidth
            ZIndex: =1

        Title10 As label:
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            Height: =EmailPeopleGallery2.TemplateHeight
            OnSelect: =Set(_selectedUser, ThisItem)
            PaddingLeft: =10
            Size: =13
            TabIndex: =If(PeopleBrowseGallery2.Visible, -1, 0)
            Text: =ThisItem.DisplayName
            Width: =EmailPeopleGallery2.TemplateWidth - iconRemove2.Width + 10
            Wrap: =false
            ZIndex: =2

        iconRemove2 As icon.Cancel:
            AccessibleLabel: =iconRemove2.Tooltip
            BorderColor: =RGBA(166, 166, 166, 1)
            Color: =Title10.Color
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(220, 220, 220, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Height: =EmailPeopleGallery2.TemplateHeight
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            HoverFill: =RGBA(0, 0, 0, 0)
            Icon: =Icon.Cancel
            OnSelect: =Remove(MyPeople, LookUp(MyPeople, UserPrincipalName = ThisItem.UserPrincipalName))
            PaddingBottom: =9
            PaddingLeft: =9
            PaddingRight: =9
            PaddingTop: =9
            PressedBorderColor: =RGBA(0, 0, 0, 0)
            PressedColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            PressedFill: =RGBA(0, 0, 0, 0)
            TabIndex: =If(PeopleBrowseGallery2.Visible, -1, 0)
            Tooltip: ="Select to remove user from collection"
            Width: =Self.Height
            X: =EmailPeopleGallery2.TemplateWidth - Self.Width
            ZIndex: =3

    LblEmailSubject2 As label:
        Color: =RGBA(51, 51, 51, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        PaddingLeft: =0
        Size: =13
        Text: ="*Subject"
        Width: =Parent.Width - Self.X * 2
        Wrap: =false
        X: =32
        Y: =EmailPeopleGallery2.Y + EmailPeopleGallery2.Height + 16
        ZIndex: =9

    TextEmailSubject2 As text:
        AccessibleLabel: ="A subject is required to send an email."
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        Default: =""
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        HintText: ="Add a subject"
        HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverColor: =RGBA(51, 51, 51, 1)
        HoverFill: =RGBA(255, 255, 255, 1)
        PressedBorderColor: =RGBA(0, 120, 212, 1)
        PressedColor: =RGBA(51, 51, 51, 1)
        PressedFill: =RGBA(255, 255, 255, 1)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =13
        TabIndex: =If(PeopleBrowseGallery2.Visible, -1, 0)
        Width: =Parent.Width - Self.X * 2
        X: =32
        Y: =LblEmailSubject2.Y + LblEmailSubject2.Height + 3
        ZIndex: =10

    LblEmailMessage2 As label:
        Color: =RGBA(51, 51, 51, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        Font: =Font.'Segoe UI'
        PaddingLeft: =0
        Size: =13
        Text: ="Message"
        Width: =200
        Wrap: =false
        X: =32
        Y: =TextEmailSubject2.Y + TextEmailSubject2.Height + 16
        ZIndex: =11

    TextEmailMessage2 As text:
        AccessibleLabel: ="Add a message"
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =2
        Color: =RGBA(51, 51, 51, 1)
        Default: =""
        DisabledBorderColor: =RGBA(0, 0, 0, 0)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        FocusedBorderThickness: =4
        Font: =Font.'Segoe UI'
        Height: =238
        HintText: ="Add a message"
        HoverBorderColor: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        HoverColor: =RGBA(51, 51, 51, 1)
        HoverFill: =RGBA(255, 255, 255, 1)
        Mode: =TextMode.MultiLine
        PressedBorderColor: =RGBA(0, 120, 212, 1)
        PressedColor: =RGBA(51, 51, 51, 1)
        PressedFill: =RGBA(255, 255, 255, 1)
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =13
        TabIndex: =If(PeopleBrowseGallery2.Visible, -1, 0)
        Width: =Parent.Width - Self.X * 2
        X: =32
        Y: =317
        ZIndex: =12

    PeopleBrowseGallery2 As gallery.PeoplePickerGallerySmallTablet:
        AccessibleLabel: ="User look up search results"
        BorderColor: =RGBA(166, 166, 166, 1)
        BorderThickness: =2
        Fill: =Parent.Fill
        Height: =If(Self.Visible, Parent.Height / 2 + 200, 0)
        Items: |-
            =/*Only use Office 365 Users operation if user has started searching*/
            If(!IsBlank(Trim(TextSearchBox2.Text)), Office365Users.SearchUser({searchTerm: Trim(TextSearchBox2.Text), top: 15}))
        Layout: =Layout.Vertical
        TemplatePadding: =0
        TemplateSize: =104
        Visible: =!IsBlank(Trim(TextSearchBox2.Text))
        Width: =Parent.Width - Self.X * 2
        X: =32
        Y: =TextSearchBox2.Y + TextSearchBox2.Height
        ZIndex: =13

        Rectangle10 As rectangle:
            BorderColor: =Title11.Color
            BorderThickness: =If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName, 4, 0)
            DisabledFill: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(0,0,0,0)
            Height: =Parent.TemplateHeight
            HoverFill: =RGBA(0,0,0,0)
            OnSelect: =Select(Title11)
            PressedFill: =RGBA(0, 120, 212, 1)
            Width: =Parent.TemplateWidth
            ZIndex: =1

        Title11 As label:
            BorderColor: =Self.Color
            Color: =RGBA(51, 51, 51, 1)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            OnSelect: |-
                =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                Concurrent(
                Set(_selectedUser, ThisItem),
                Reset(TextSearchBox2),
                If(Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName), Collect(MyPeople, ThisItem)))
            Size: =17
            TabIndex: =0
            Text: =ThisItem.DisplayName
            Width: =PeopleBrowseGallery2.TemplateWidth - 2 * Self.X
            Wrap: =false
            X: =16
            Y: =4
            ZIndex: =2

        Subtitle4 As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =ColorFade(Title11.Color, 0.20)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(166, 166, 166, 1)
            FocusedBorderThickness: =2
            Font: =Font.'Segoe UI'
            OnSelect: =Select(Title11)
            Size: =17
            Text: =ThisItem.UserPrincipalName
            Width: =PeopleBrowseGallery2.TemplateWidth - 2 * Self.X
            Wrap: =false
            X: =Title11.X
            Y: =Title11.Y + Title11.Height + 3
            ZIndex: =3

        Separator4 As rectangle:
            BorderColor: =RGBA(0, 0, 0, 0)
            Fill: =ColorFade(RGBA(0, 120, 212, 1), -30%)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =4

